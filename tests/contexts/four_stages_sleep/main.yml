stages:
  main:
    image:
        type: docker
        path: ubuntu-trusty-ctxt
    steps:
      - ShellCommand:
          command: "ls -l"
      - TriggerStages:
          stage_names:
            - compile
            - test
          waitForFinish: True
      - TriggerStages:
          stage_names:
            - finalize
          waitForFinish: True
  compile:
    image:
        type: docker
        path: ubuntu-trusty-ctxt
    steps:
      - ShellCommand:
          command: "sleep 1"
  test:
    image:
        type: docker
        path: ubuntu-trusty-ctxt
    steps:
      - ShellCommand:
          command: "sleep 2"
  finalize:
    image:
      type: docker
      path: ubuntu-trusty-ctxt
    steps:
      - ShellCommand:
          command: "sleep 4"