branches:
  default:
    stage: write

stages:
  write:
    worker:
        type: docker
        path: eve/centos7-ctxt
        volumes:
          - 'testcache:/write'
    steps:
      - ShellCommand:
          name: create artifacts dir
          command: mkdir artifacts
      - ShellCommand:
          name: create a file in artifacts dir
          command: >
              mkdir artifacts/test
              && echo 'hello' > artifacts/test/hello.txt
              && echo 'hello' > artifacts/test/hello_2.txt
              && echo 'hello' > artifacts/hello.txt
      - SetPropertyFromCommand:
          name: set build id
          command: echo 'eve_test_build_id'
          property: build_id
      - Upload:
          source: artifacts
          urls:
           - hello.txt
           - ['files in test directory : ', 'test/*']
           - ['every hello files : ', '*hello*']
           - a_path_pattern_with_no_match
           - [a_prefix, a_path_pattern_with_no_match]
           - '*'
           - ['?ello.txt : ', '?ello.txt']
           - ['h*o.txt : ', 'h*o.txt']
           - ['test/h* : ', 'test/h*']
           - ['/h : ', '/h']
           - ['h.t : ', 'h.t']
           - ['*/.txt : ', '*/.txt']
           - ['*hello.txt : ', '*hello.txt']
           - ['hello.txt* : ', 'hello.txt*']
           - ['hello from path: \1', '*hello.txt']
      - Download:
          name: tries to download uploaded files
          files:
            - hello.txt
            - test/hello.txt
            - test/hello_2.txt
